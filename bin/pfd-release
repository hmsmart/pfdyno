#!/usr/bin/env python3
# cmd (table, ip, hw)
import sys 
import syslog
import mmap

table = sys.argv[1]
ip = sys.argv[2]
hw = sys.argv[3]

#load table
with open(f"/home/_pfdyno/anchors/{table}_leased.txt", "r") as lf:
    leases = lf.readLines()
    inLeaseTable = False
    for lease_line in leases:
        if ip in lease_line:
                inLeaseTable = True;
                syslog.syslog("ip in file, removing")
                with open (f"/home/_pfdyno/anchors/{table}_leased.txt", "w") as wlf:
                    for lease_line in leases:
                        if not ip in lease_line:
                            wlf.write(lease_line)
                break
    if inLeaseTable:
        syslog.syslog(f"syscall to pf for reload");
    if not inLeaseTable:
        syslog.syslog(f"Do nothing :)")